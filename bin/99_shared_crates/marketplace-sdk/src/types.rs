// TEAM-402: Marketplace types with tsify for TypeScript generation
// TEAM-402: Can now use artifacts-contract types if needed

use serde::{Deserialize, Serialize};
use tsify::Tsify;
use wasm_bindgen::prelude::*;

// TEAM-402: Re-export core artifact types (catalog types)
// Note: Marketplace has its own Worker/WorkerType for display purposes
pub use artifacts_contract::{ModelEntry as CatalogModelEntry, WorkerBinary as CatalogWorkerBinary};

/// Model from marketplace (HuggingFace or CivitAI)
/// 
/// TEAM-402: TypeScript types are AUTO-GENERATED by tsify.
/// Import from SDK: `import type { Model } from '@rbee/marketplace-sdk'`
#[derive(Debug, Clone, Serialize, Deserialize, Tsify)]
#[tsify(into_wasm_abi, from_wasm_abi)]
#[serde(rename_all = "camelCase")]
pub struct Model {
    pub id: String,
    pub name: String,
    pub description: String,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub author: Option<String>,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub image_url: Option<String>,
    pub tags: Vec<String>,
    pub downloads: u64,
    pub likes: u64,
    pub size: String,
    pub source: ModelSource,
}

/// Model source
#[derive(Debug, Clone, Serialize, Deserialize, Tsify)]
#[tsify(into_wasm_abi, from_wasm_abi)]
pub enum ModelSource {
    HuggingFace,
    CivitAI,
}

/// Worker binary info
#[derive(Debug, Clone, Serialize, Deserialize, Tsify)]
#[tsify(into_wasm_abi, from_wasm_abi)]
#[serde(rename_all = "camelCase")]
pub struct Worker {
    pub id: String,
    pub name: String,
    pub description: String,
    pub version: String,
    pub platform: Vec<String>,
    pub architecture: Vec<String>,
    pub worker_type: WorkerType,
}

/// Worker type
#[derive(Debug, Clone, Serialize, Deserialize, Tsify)]
#[tsify(into_wasm_abi, from_wasm_abi)]
pub enum WorkerType {
    #[serde(rename = "cpu")]
    Cpu,
    #[serde(rename = "cuda")]
    Cuda,
    #[serde(rename = "metal")]
    Metal,
}

/// Model filters
#[derive(Debug, Clone, Serialize, Deserialize, Tsify)]
#[tsify(into_wasm_abi, from_wasm_abi)]
pub struct ModelFilters {
    #[serde(skip_serializing_if = "Option::is_none")]
    pub search: Option<String>,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub category: Option<String>,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub sort: Option<SortOrder>,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub limit: Option<u32>,
}

/// Sort order
#[derive(Debug, Clone, Serialize, Deserialize, Tsify)]
#[tsify(into_wasm_abi, from_wasm_abi)]
pub enum SortOrder {
    Popular,
    Recent,
    Trending,
}
